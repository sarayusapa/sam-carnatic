# Configuration file for SAM-Audio model training
# Optimized for RTX 4090 (24GB VRAM)

# Training parameters
num_epochs: 50
batch_size: 32                    # Increased for 4090's 24GB VRAM
learning_rate: 3e-4               # Slightly higher LR works well with larger batches
random_seed: 42
weight_decay: 0.01
max_grad_norm: 1.0                # Gradient clipping for stability
gradient_accumulation_steps: 1    # Increase if OOM (effective batch = batch_size * this)
warmup_epochs: 2                  # Learning rate warmup
patience: 10                      # Early stopping patience

# Data parameters
mask_ratio: 0.15
temperature: 0.07
num_segments: 64

# Loss weights
mask_weight: 0.5
contrastive_weight: 0.3

# Encoder parameters
encoder_dims: [64, 128, 256, 512]
kernel_size: 3
stride: 2
dropout_rate: 0.1
use_layer_norm: true              # More stable than BatchNorm for audio

# RTX 4090 optimizations
compile_model: true               # torch.compile() for faster execution
num_workers: 4                    # DataLoader workers (adjust based on CPU cores)

# Logging and saving
wandb_project: "sam-carnatic"
run_name: "sam-audio-rtx4090"
best_model_path: "best_model.pth"
final_model_path: "final_model.pth"

# Model pushing
push_to_hub: true
model_name: "sarayusapa/sam-carnatic"
